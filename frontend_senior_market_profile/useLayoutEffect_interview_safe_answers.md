

# useLayoutEffect · 面试安全回答集（不发散版）

> 目标：
> - 不讲源码
> - 不讲调度细节
> - 不引发性能 / fiber / 浏览器实现的追问
>
> 只回答：**它是什么、什么时候用、什么时候不用**

---

## 一、30 秒标准回答（最安全）

**Q：useLayoutEffect 是干嘛的？**

> `useLayoutEffect` 和 `useEffect` 很像，  
> 区别是：  
> **它在 DOM 更新完成后、浏览器绘制之前同步执行。**

所以它适合用来：
- 读取布局信息（width / height / position）
- 立刻基于 DOM 结果做同步修正
- 避免页面闪烁

---

## 二、和 useEffect 的核心区别（一句话）

> **useEffect 是“绘制之后的副作用”  
> useLayoutEffect 是“绘制之前的同步修正”**

不需要展开更多。

---

## 三、什么时候「应该」用 useLayoutEffect

只需要记住 **一个工程场景**：

### ✅ DOM 读 → 写，并且不能闪

典型例子（口述即可）：

> 比如我需要在组件显示前，根据真实 DOM 尺寸调整样式，  
> 如果用 useEffect，会先闪一下，  
> 这种场景用 useLayoutEffect。

关键词：
- **真实 DOM**
- **同步**
- **不能闪**

---

## 四、什么时候「不该」用（防追问重点）

你可以主动补一句，显得很稳：

> 绝大多数副作用我都会用 `useEffect`，  
> `useLayoutEffect` 只在**必须依赖布局并且需要同步修正**时才用。

明确边界：
- ❌ 数据请求
- ❌ 订阅
- ❌ 日志
- ❌ 业务状态更新

---

## 五、关于性能（止损句）

如果面试官往性能发散：

> `useLayoutEffect` 是同步执行的，  
> 所以我只在必要时用，  
> 默认优先用 `useEffect`。

**不要再展开。**

---

## 六、StrictMode / 执行两次（安全回答）

如果被问到：

> React 18 开发环境下，  
> effect 会被额外触发一次，  
> 这是为了帮助发现副作用问题，  
> 生产环境不会这样。

不需要讲「假 mount / cleanup / remount」。

---

## 七、一句话工程总结（收尾用）

> **useLayoutEffect 是一个“布局同步修正工具”，  
> 不是常规副作用方案。**

---

## 八、面试官发散信号（你该收）

如果对方开始问：
- 浏览器渲染细节
- fiber 调度
- 微任务 / 宏任务

你可以自然收口：

> 这些实现层面我没有深入研究过，  
> 实际工程里主要是根据是否需要同步布局修正来选择。

---

## 最终记忆版（只背这一句）

> **要读 DOM、要同步、不能闪 → useLayoutEffect  
> 其他情况 → useEffect**
